class Goods

  # Adding goods to inventory workflow
  search_existent_good_event: ->
    $(".search_existent_good input.search").bind 'keyup', (event) =>
      @search_existent_good_post($(event.target))
      
  search_existent_good_post: (element) ->
    string = element.val()
    path = element.data("path")
    $.post(
        path,
        { "name": string },
        (response) =>
          $(".search_existent_good .search_results").html(response)
          @bind_search_results_to_new_form()
      )

  bind_search_results_to_new_form: ->
    $(".search_existent_good .search_results ul li a[data-async='true']").bind "click", (event)->
      $.get(
        $(event.target).attr("href"),
        (response) ->
          $("#main").html response
      )
      false

  init: ->
    @search_existent_good_event()

$( ->
  goods = new Goods
  goods.init()
)
